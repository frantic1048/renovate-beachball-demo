"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.areChangeFilesDeleted = void 0;
const paths_1 = require("../paths");
const workspace_tools_1 = require("workspace-tools");
function areChangeFilesDeleted(options) {
    const { branch, path: cwd } = options;
    const root = (0, workspace_tools_1.findProjectRoot)(cwd);
    const changePath = (0, paths_1.getChangePath)(cwd);
    console.log(`Checking for deleted change files against "${branch}"`);
    const changeFilesDeletedSinceRef = (0, workspace_tools_1.getChangesBetweenRefs)(branch, 'HEAD', [
        '--diff-filter=D', // showing only deleted files from the diff.
    ], `${changePath}/*.json`, root);
    if (changeFilesDeletedSinceRef.length) {
        const changeFiles = changeFilesDeletedSinceRef.map(file => `- ${file}`);
        console.error(`ERROR: The following change files were deleted:\n${changeFiles.join('\n')}\n`);
        return true;
    }
    return false;
}
exports.areChangeFilesDeleted = areChangeFilesDeleted;
//# sourceMappingURL=areChangeFilesDeleted.js.map